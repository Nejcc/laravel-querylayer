<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laravel QueryLayer Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <!-- Prism CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        .sidebar {
            height: calc(100vh - 4rem);
            position: sticky;
            top: 4rem;
        }
        .content {
            max-width: 65ch;
        }
        /* Enhanced code block styling */
        pre {
            background: #1a1a1a !important;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            padding: 1rem !important;
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        pre code {
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            padding: 0 !important;
            background: transparent !important;
        }
        /* Code block header */
        .code-header {
            background: #2d2d2d;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #e0e0e0;
            font-size: 0.875rem;
            border-bottom: 1px solid #404040;
        }
        /* Line numbers */
        .line-numbers .line-numbers-rows {
            border-right: 1px solid #404040;
            padding-right: 1rem;
            margin-right: 1rem;
        }
        /* Copy button */
        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.25rem 0.5rem;
            background: #404040;
            border-radius: 0.25rem;
            color: #e0e0e0;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .copy-button:hover {
            background: #505050;
        }
        .search-highlight {
            background-color: rgba(255, 255, 0, 0.3);
            padding: 0.1em 0.2em;
            border-radius: 0.2em;
        }
        .search-result {
            transition: all 0.2s ease-in-out;
        }
        .search-result:hover {
            transform: translateX(0.5rem);
        }
        /* Inline code styling */
        code:not(pre code) {
            background: #f3f4f6;
            padding: 0.2em 0.4em;
            border-radius: 0.25rem;
            font-size: 0.875em;
            color: #1f2937;
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        /* Enhanced section highlighting */
        .section-highlight {
            position: relative;
        }
        
        .section-highlight::before {
            content: '';
            position: absolute;
            left: -1rem;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #3b82f6;
            border-radius: 2px;
            transform: scaleY(0);
            transition: transform 0.2s ease-in-out;
        }
        
        .section-highlight.active::before {
            transform: scaleY(1);
        }

        /* Centered search */
        .search-container {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            max-width: 90%;
        }

        .search-input {
            width: 100%;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease-in-out;
        }

        .search-input:focus {
            background: white;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Smooth scroll behavior */
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 5rem;
        }

        /* Submenu styling */
        .submenu {
            margin-left: 1rem;
            border-left: 2px solid #e5e7eb;
            padding-left: 0.5rem;
        }

        .submenu-item {
            font-size: 0.875rem;
            color: #4b5563;
            transition: all 0.2s;
        }

        .submenu-item:hover {
            color: #3b82f6;
        }

        .submenu-item.active {
            color: #3b82f6;
            font-weight: 500;
        }

        /* Nested content styling */
        .subsection {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .subsection:first-child {
            margin-top: 1rem;
            padding-top: 0;
            border-top: none;
        }

        /* Collapsible sections */
        .collapsible {
            cursor: pointer;
            user-select: none;
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .collapsible-content.expanded {
            max-height: 1000px;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between h-16">
                    <div class="flex">
                        <div class="flex-shrink-0 flex items-center">
                            <h1 class="text-xl font-bold text-gray-800">Laravel QueryLayer</h1>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <!-- Centered Search Bar -->
                        <div class="search-container">
                            <input 
                                type="text" 
                                v-model="searchQuery" 
                                @input="performSearch"
                                placeholder="Search documentation..." 
                                class="search-input px-4 py-2 rounded-lg"
                            >
                            <div v-if="searchResults.length > 0" 
                                 class="absolute top-full left-0 w-full mt-2 bg-white rounded-lg shadow-lg border border-gray-200 max-h-96 overflow-y-auto z-50">
                                <div v-for="result in searchResults" 
                                     :key="result.id" 
                                     class="p-3 hover:bg-gray-50 cursor-pointer search-result" 
                                     @click="scrollToSection(result.id)">
                                    <div class="font-medium text-gray-900" v-html="result.title"></div>
                                    <div class="text-sm text-gray-600" v-html="result.excerpt"></div>
                                </div>
                            </div>
                        </div>
                        <a href="https://github.com/nejcc/laravel-querylayer" class="text-gray-600 hover:text-gray-900 ml-4">
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="max-w-7xl mx-auto px-4 pt-20">
            <div class="flex">
                <!-- Sidebar -->
                <div class="w-64 flex-shrink-0 pr-8">
                    <div class="sidebar overflow-y-auto">
                        <nav class="space-y-1">
                            <template v-for="section in sections" :key="section.id">
                                <div class="collapsible" @click="toggleSection(section.id)">
                                    <a :href="'#' + section.id"
                                       class="block px-3 py-2 rounded-md text-gray-700 hover:bg-gray-50 transition-colors duration-200"
                                       :class="{ 'bg-blue-50 text-blue-700': activeSection === section.id }"
                                       @click.prevent="setActiveSection(section.id)">
                                        {{ section.title }}
                                    </a>
                                </div>
                                <div class="submenu collapsible-content" :class="{ 'expanded': expandedSections.includes(section.id) }">
                                    <a v-for="subsection in section.subsections"
                                       :key="subsection.id"
                                       :href="'#' + subsection.id"
                                       class="block px-3 py-1.5 submenu-item"
                                       :class="{ 'active': activeSubsection === subsection.id }"
                                       @click="setActiveSubsection(subsection.id)">
                                        {{ subsection.title }}
                                    </a>
                                </div>
                            </template>
                        </nav>
                    </div>
                </div>

                <!-- Content -->
                <div class="flex-1 content">
                    <template v-for="section in sections" :key="section.id">
                        <section :id="section.id" class="mb-12 section-highlight" :class="{ 'active': activeSection === section.id }">
                            <h2 class="text-3xl font-bold mb-4">{{ section.title }}</h2>
                            <p class="text-gray-700 mb-4">{{ section.description }}</p>
                            
                            <template v-for="subsection in section.subsections" :key="subsection.id">
                                <div :id="subsection.id" class="subsection">
                                    <h3 class="text-2xl font-semibold mb-3">{{ subsection.title }}</h3>
                                    <div v-html="subsection.content"></div>
                                </div>
                            </template>
                        </section>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Prism plugins -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    
    <script>
        const { createApp, ref, computed, onMounted } = Vue

        createApp({
            setup() {
                const searchQuery = ref('')
                const activeSection = ref('introduction')
                const activeSubsection = ref('')
                const expandedSections = ref(['introduction'])
                const searchResults = ref([])
                
                const sections = [
                    {
                        id: 'introduction',
                        title: 'Introduction',
                        description: 'Get started with Laravel QueryLayer, a powerful repository pattern implementation for Laravel applications.',
                        subsections: [
                            {
                                id: 'introduction-overview',
                                title: 'Overview',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        Laravel QueryLayer provides a clean and maintainable way to handle database operations 
                                        in your Laravel projects, with built-in singleton pattern support for efficient 
                                        repository management.
                                    </p>
                                    <p class="text-gray-700 mb-4">
                                        This package is designed to simplify your database interactions while maintaining 
                                        type safety and following Laravel's best practices. It's perfect for projects that 
                                        need a structured approach to database operations without sacrificing flexibility.
                                    </p>
                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <h3 class="text-sm font-medium text-blue-800">Key Features</h3>
                                                <div class="mt-2 text-sm text-blue-700">
                                                    <ul class="list-disc pl-5 space-y-1">
                                                        <li>Quick repository creation for any Eloquent model</li>
                                                        <li>Full CRUD operations out of the box</li>
                                                        <li>Type-safe with PHP 8.0+ features</li>
                                                        <li>Query builder access for complex queries</li>
                                                        <li>Pagination support</li>
                                                        <li>Extensible base repository</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `
                            },
                            {
                                id: 'introduction-requirements',
                                title: 'Requirements',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        Before you begin, ensure your development environment meets the following requirements:
                                    </p>
                                    <ul class="list-disc pl-5 space-y-2 text-gray-700">
                                        <li>PHP 8.0 or higher - Required for type safety and modern PHP features</li>
                                        <li>Laravel 8.0 or higher - Ensures compatibility with modern Laravel features</li>
                                        <li>Composer for package management - Required for installation and dependency management</li>
                                    </ul>
                                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-yellow-700">
                                                    While PHP 8.0 is the minimum requirement, we recommend using PHP 8.1 or higher 
                                                    to take advantage of all modern PHP features and improvements.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            }
                        ]
                    },
                    {
                        id: 'installation',
                        title: 'Installation',
                        description: 'Learn how to install and configure Laravel QueryLayer in your project.',
                        subsections: [
                            {
                                id: 'installation-composer',
                                title: 'Via Composer',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        The recommended way to install Laravel QueryLayer is through Composer. This ensures 
                                        all dependencies are properly managed and the package is correctly integrated into 
                                        your Laravel application.
                                    </p>
                                    <pre><code class="language-bash">composer require nejcc/laravel-querylayer</code></pre>
                                    <p class="text-gray-700 mt-4">
                                        After installation, the package will automatically register its service provider. 
                                        You can verify the installation by checking your <code>composer.json</code> file, 
                                        which should now include the package in its dependencies.
                                    </p>
                                `
                            },
                            {
                                id: 'installation-configuration',
                                title: 'Configuration',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        While Laravel QueryLayer works out of the box with sensible defaults, you can 
                                        customize its behavior by publishing the configuration file. This is optional but 
                                        recommended for projects that need specific configurations.
                                    </p>
                                    <pre><code class="language-bash">php artisan vendor:publish --provider="Nejcc\LaravelQuerylayer\QueryLayerServiceProvider"</code></pre>
                                    <p class="text-gray-700 mt-4">
                                        This command will publish the configuration file to <code>config/querylayer.php</code>. 
                                        Here you can customize various aspects of the package, such as:
                                    </p>
                                    <ul class="list-disc pl-5 space-y-2 text-gray-700 mt-4">
                                        <li>Default pagination settings</li>
                                        <li>Cache configuration</li>
                                        <li>Repository naming conventions</li>
                                        <li>Custom model interfaces</li>
                                    </ul>
                                `
                            }
                        ]
                    },
                    {
                        id: 'model-interface',
                        title: 'Model Interface',
                        description: 'Learn how to use repository functionality directly on your models.',
                        subsections: [
                            {
                                id: 'model-interface-setup',
                                title: 'Basic Setup',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        The Model Interface feature allows you to use repository functionality directly on 
                                        your Eloquent models. This provides a clean and intuitive way to interact with your 
                                        data while maintaining the benefits of the repository pattern.
                                    </p>
                                    <p class="text-gray-700 mb-4">
                                        To implement this feature, your model needs to:
                                    </p>
                                    <ol class="list-decimal pl-5 space-y-2 text-gray-700 mb-4">
                                        <li>Implement the <code>ModelInterface</code> contract</li>
                                        <li>Use the <code>HasRepository</code> trait</li>
                                        <li>Define the repository class to use</li>
                                    </ol>
                                    <pre><code class="language-php">use Nejcc\LaravelQuerylayer\Contracts\ModelInterface;
use Nejcc\LaravelQuerylayer\Traits\HasRepository;

class User extends Model implements ModelInterface
{
    use HasRepository;

    protected static function getRepositoryClass(): string
    {
        return UserRepository::class;
    }
}</code></pre>
                                    <p class="text-gray-700 mt-4">
                                        This setup provides a seamless integration between your models and repositories, 
                                        allowing you to use repository methods directly on your model instances.
                                    </p>
                                `
                            },
                            {
                                id: 'model-interface-usage',
                                title: 'Usage Examples',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        Once you've set up the model interface, you can use repository methods directly on 
                                        your models. Here are some common use cases:
                                    </p>
                                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                                        <h4 class="font-semibold text-gray-800 mb-2">Basic CRUD Operations</h4>
                                        <pre><code class="language-php">// Create a new user
$user = User::createRecord([
    'name' => 'John Doe',
    'email' => 'john@example.com'
]);

// Find a user
$user = User::findById(1);
$user = User::findByColumn('email', 'john@example.com');

// Get all users
$users = User::getAll();

// Get paginated users
$users = User::getPaginated(10);

// Get users with conditions
$users = User::getWhere(['role' => 'admin']);

// Update a user
User::updateRecord(1, ['name' => 'Jane Doe']);

// Delete a user
User::deleteRecord(1);</code></pre>
                                    </div>

                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <h4 class="font-semibold text-gray-800 mb-2">Advanced Operations</h4>
                                        <pre><code class="language-php">// Get the query builder
$query = User::getQuery();

// Get the repository instance
$repository = User::getRepository();</code></pre>
                                    </div>

                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-blue-700">
                                                    The model interface provides a convenient way to access repository 
                                                    functionality while maintaining the benefits of the repository pattern. 
                                                    This approach is particularly useful for simple CRUD operations and 
                                                    when you want to keep your code clean and intuitive.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            }
                        ]
                    },
                    {
                        id: 'repository-pattern',
                        title: 'Repository Pattern',
                        description: 'Learn how to implement and extend the repository pattern.',
                        subsections: [
                            {
                                id: 'repository-pattern-basic',
                                title: 'Basic Repository',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        The repository pattern provides a clean abstraction layer between your domain logic 
                                        and data access. Laravel QueryLayer makes it easy to implement this pattern in your 
                                        Laravel applications.
                                    </p>
                                    <p class="text-gray-700 mb-4">
                                        To create a basic repository, extend the <code>BaseRepository</code> class and 
                                        specify your model:
                                    </p>
                                    <pre><code class="language-php">use Nejcc\LaravelQuerylayer\Repositories\BaseRepository;
use App\Models\User;

class UserRepository extends BaseRepository
{
    protected function model(): string
    {
        return User::class;
    }
}</code></pre>
                                    <p class="text-gray-700 mt-4">
                                        This basic setup provides you with all the essential CRUD operations and query 
                                        building capabilities. The repository will automatically handle model instantiation 
                                        and basic database operations.
                                    </p>
                                `
                            },
                            {
                                id: 'repository-pattern-advanced',
                                title: 'Advanced Usage',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        For more complex scenarios, you can extend the basic repository with custom methods 
                                        and query scopes. This allows you to encapsulate complex database operations and 
                                        business logic within your repository.
                                    </p>
                                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                                        <h4 class="font-semibold text-gray-800 mb-2">Custom Repository Methods</h4>
                                        <pre><code class="language-php">class UserRepository extends BaseRepository
{
    public function getActiveAdminsPaginated(?int $perPage = null): LengthAwarePaginator
    {
        return $this->getActiveAdminsQuery()->paginate($perPage);
    }

    public function getActiveAdminsQuery(): Builder
    {
        return $this->query()
            ->where('is_active', true)
            ->where('role', 'admin');
    }
}</code></pre>
                                    </div>

                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-blue-700">
                                                    Advanced repository methods help you maintain clean and maintainable code 
                                                    by encapsulating complex database operations. This approach is particularly 
                                                    useful for business logic that involves multiple database queries or 
                                                    complex conditions.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            }
                        ]
                    },
                    {
                        id: 'advanced-features',
                        title: 'Advanced Features',
                        description: 'Explore advanced features and best practices.',
                        subsections: [
                            {
                                id: 'advanced-features-chaining',
                                title: 'Method Chaining',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        Laravel QueryLayer supports method chaining for building complex queries. This 
                                        allows you to create readable and maintainable query chains while maintaining 
                                        type safety.
                                    </p>
                                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                                        <h4 class="font-semibold text-gray-800 mb-2">Query Building</h4>
                                        <pre><code class="language-php">// Chain methods for a single query
$adminUsers = $userRepository
    ->with('posts')
    ->where(['role' => 'admin'])
    ->paginate(15);

// For limited dataset
$recentPosts = $postRepository
    ->query()
    ->orderBy('created_at', 'desc')
    ->limit(5)
    ->get();</code></pre>
                                    </div>

                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-blue-700">
                                                    Method chaining provides a fluent interface for building queries, making 
                                                    your code more readable and maintainable. Each method in the chain 
                                                    returns a new query builder instance, allowing you to build complex 
                                                    queries step by step.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            },
                            {
                                id: 'advanced-features-transactions',
                                title: 'Transactions',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        Database transactions ensure data integrity by grouping multiple operations into a 
                                        single atomic unit. Laravel QueryLayer provides convenient methods for working with 
                                        transactions.
                                    </p>
                                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                                        <h4 class="font-semibold text-gray-800 mb-2">Transaction Methods</h4>
                                        <pre><code class="language-php">// Wrap multiple operations in a transaction
$userRepository->transaction(function () use ($userRepository) {
    $user = $userRepository->create(['name' => 'Transaction User']);
    $userRepository->update($user->id, ['name' => 'Updated User']);
    return $user;
});

// Or use the convenient methods
$user = $userRepository->createOrFail(['name' => 'Safe Create']);
$success = $userRepository->updateOrFail(1, ['name' => 'Safe Update']);</code></pre>
                                    </div>

                                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-yellow-700">
                                                    Always use transactions when performing multiple related database 
                                                    operations. This ensures that either all operations succeed or none of 
                                                    them do, maintaining data consistency.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            },
                            {
                                id: 'advanced-features-database',
                                title: 'Direct Database Access',
                                content: `
                                    <p class="text-gray-700 mb-4">
                                        While the repository pattern provides a clean abstraction, sometimes you need direct 
                                        access to the database for complex operations. Laravel QueryLayer allows you to 
                                        access the database directly when needed.
                                    </p>
                                    <div class="bg-gray-50 p-4 rounded-lg mb-4">
                                        <h4 class="font-semibold text-gray-800 mb-2">Database Operations</h4>
                                        <pre><code class="language-php">// Get raw database query builder
$usersTable = $userRepository->db();

// Complex SQL operations
$activeUsersByRole = $userRepository->db()
    ->select('role', $userRepository->db()->raw('COUNT(*) as count'))
    ->where('is_active', true)
    ->groupBy('role')
    ->orderBy('count', 'desc')
    ->get();</code></pre>
                                    </div>

                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-4">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                                                </svg>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-blue-700">
                                                    Direct database access is useful for complex queries that can't be easily 
                                                    expressed through the repository pattern. However, use this feature 
                                                    sparingly and prefer repository methods when possible to maintain code 
                                                    consistency and maintainability.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                `
                            }
                        ]
                    }
                ]

                // Define all functions first
                const setActiveSection = (sectionId) => {
                    activeSection.value = sectionId
                    if (!expandedSections.value.includes(sectionId)) {
                        expandedSections.value.push(sectionId)
                    }
                }

                const setActiveSubsection = (subsectionId) => {
                    activeSubsection.value = subsectionId
                    const section = sections.find(s => s.subsections.some(sub => sub.id === subsectionId))
                    if (section) {
                        activeSection.value = section.id
                        if (!expandedSections.value.includes(section.id)) {
                            expandedSections.value.push(section.id)
                        }
                    }
                }

                const toggleSection = (sectionId) => {
                    const index = expandedSections.value.indexOf(sectionId)
                    if (index === -1) {
                        expandedSections.value.push(sectionId)
                    } else {
                        expandedSections.value.splice(index, 1)
                    }
                }

                const performSearch = () => {
                    if (!searchQuery.value) {
                        searchResults.value = []
                        return
                    }

                    const query = searchQuery.value.toLowerCase()
                    const results = []

                    sections.forEach(section => {
                        // Search in section content
                        const sectionElement = document.getElementById(section.id)
                        if (sectionElement) {
                            const content = sectionElement.textContent.toLowerCase()
                            if (content.includes(query)) {
                                results.push({
                                    id: section.id,
                                    title: section.title,
                                    excerpt: highlightText(content.substring(
                                        Math.max(0, content.indexOf(query) - 50),
                                        Math.min(content.length, content.indexOf(query) + 50)
                                    ), query)
                                })
                            }
                        }

                        // Search in subsections
                        section.subsections.forEach(subsection => {
                            const subsectionElement = document.getElementById(subsection.id)
                            if (subsectionElement) {
                                const content = subsectionElement.textContent.toLowerCase()
                                if (content.includes(query)) {
                                    results.push({
                                        id: subsection.id,
                                        title: `${section.title} > ${subsection.title}`,
                                        excerpt: highlightText(content.substring(
                                            Math.max(0, content.indexOf(query) - 50),
                                            Math.min(content.length, content.indexOf(query) + 50)
                                        ), query)
                                    })
                                }
                            }
                        })
                    })

                    searchResults.value = results
                }

                const highlightText = (text, query) => {
                    const regex = new RegExp(`(${query})`, 'gi')
                    return text.replace(regex, '<span class="search-highlight">$1</span>')
                }

                const scrollToSection = (sectionId) => {
                    const element = document.getElementById(sectionId)
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' })
                        const section = sections.find(s => s.id === sectionId || s.subsections.some(sub => sub.id === sectionId))
                        if (section) {
                            activeSection.value = section.id
                            if (!expandedSections.value.includes(section.id)) {
                                expandedSections.value.push(section.id)
                            }
                        }
                        searchResults.value = []
                        history.replaceState(null, null, `#${sectionId}`)
                    }
                }

                // Add copy button functionality
                const addCopyButtons = () => {
                    document.querySelectorAll('pre code').forEach((block) => {
                        const button = document.createElement('button')
                        button.className = 'copy-button'
                        button.textContent = 'Copy'
                        button.addEventListener('click', () => {
                            navigator.clipboard.writeText(block.textContent)
                            button.textContent = 'Copied!'
                            setTimeout(() => {
                                button.textContent = 'Copy'
                            }, 2000)
                        })
                        block.parentElement.appendChild(button)
                    })
                }

                // Enhanced section tracking
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const sectionId = entry.target.id
                            activeSection.value = sectionId
                            history.replaceState(null, null, `#${sectionId}`)
                        }
                    })
                }, { 
                    threshold: 0.2,
                    rootMargin: '-100px 0px -50% 0px'
                })

                // Initialize on mount
                onMounted(() => {
                    // Observe all sections
                    sections.forEach(section => {
                        const element = document.getElementById(section.id)
                        if (element) observer.observe(element)
                    })
                    addCopyButtons()

                    // Handle initial hash in URL
                    const hash = window.location.hash.slice(1)
                    if (hash) {
                        const section = sections.find(s => s.id === hash || s.subsections.some(sub => sub.id === hash))
                        if (section) {
                            setActiveSection(section.id)
                            if (sections.some(s => s.subsections.some(sub => sub.id === hash))) {
                                setActiveSubsection(hash)
                            }
                        }
                    }
                })

                return {
                    searchQuery,
                    searchResults,
                    sections,
                    activeSection,
                    activeSubsection,
                    expandedSections,
                    performSearch,
                    scrollToSection,
                    setActiveSection,
                    setActiveSubsection,
                    toggleSection
                }
            }
        }).mount('#app')
    </script>
</body>
</html> 